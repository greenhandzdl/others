import os
import sys

def get_detailed_templates():
    return {
        # ==========================
        # 00 核心概念：定海神针
        # ==========================
        "00_核心/01_项目圣经.md": """# 项目圣经 (Project Bible)

## 1. 基础信息
- **书名（暂定）**：
- **类型**：（如：玄幻、赛博朋克、维多利亚奇幻）
- **核心梗概 (Logline)**：
  > [谁] + [面临什么危机] + [必须做什么] + [否则后果是什么]
- **预计字数**：

## 2. 核心冲突
- **外部冲突**：（主角要打败谁？要抢夺什么？）
- **内部冲突**：（主角内心的什么缺陷在阻碍他成功？）
- **哲学/主题冲突**：（例如：自由 vs 安全，复仇 vs 宽恕）

## 3. 卖点/钩子 (The Hook)
- 你的故事里最独特的“设定”或“反转”是什么？
- 为什么读者看了第一章就停不下来？
""",

        # ==========================
        # 01 大纲：路标
        # ==========================
        "01_大纲/01_细化剧情大纲.md": """# 细化剧情大纲

## 故事结构 (三幕式/起承转合)

### 第一幕：铺垫与触发
1. **开篇现状**：主角还没踏上旅程时的生活是怎样的？
2. **激励事件**：发生了什么打破了平静？（天降横祸/捡到宝物）
3. **第一幕高潮 (门槛)**：主角决定离开舒适区，正式进入“新世界”。

### 第二幕：冲突与试炼
4. **试炼与盟友**：主角遇到了谁？学会了什么新规则？
5. **中点 (Midpoint)**：故事中间的重大转折。主角从被动挨打变成主动出击，或者看似成功实则危机降临。
6. **一无所有时刻 (All is Lost)**：主角失去了依靠，看起来彻底输了。

### 第三幕：高潮与结局
7. **最终决战**：主角利用全书学到的教训，战胜反派。
8. **新常态**：故事结束，主角变成了什么样的人？

## 伏笔清单
- [ ] 伏笔1：
- [ ] 伏笔2：
""",

        # ==========================
        # 02 人物：深度挖掘
        # ==========================
        "02_人物/01_主角详表.md": """# 主角深度档案

## 1. 基础数据
- **姓名**：
- **年龄/外貌特征**：（有没有伤疤？走路姿势？标志性饰品？）
- **口头禅/说话风格**：

## 2. 内在驱动 (核心)
- **表层欲望 (Want)**：他嘴上说想要什么？（例如：我要赚钱）
- **深层需求 (Need)**：他灵魂深处缺什么？（例如：他其实需要家庭的温暖）
- **谎言 (The Lie)**：他对自己说了什么谎？（例如：“我不需要任何人。”）

## 3. 过去 (Backstory)
- **幽灵 (The Ghost)**：过去发生的哪件事造成了现在的心理创伤？
- **童年经历**：

## 4. 能力与弱点
- **高光技能**：
- **致命弱点 (Kryptonite)**：生理上或心理上的弱点。
""",

        "02_人物/02_人物关系网.md": """# 人物关系拓扑

- **主角 vs 反派**：是宿敌？是失散多年的兄弟？是镜像关系？
- **主角 vs 盟友**：互相信任吗？有没有背叛的风险？
- **反派 vs 手下**：是恐惧统治？还是忠诚信仰？
""",

        # ==========================
        # 03 世界观：面面俱到的设定
        # ==========================
        "03_世界/01_自然法则与力量体系.md": """# 力量体系设定

## 核心规则
- **能量来源**：（魔力、灵气、电力、信仰之力？）
- **使用方式**：（吟唱、画符、植入芯片、冥想？）

## 代价与限制 (这是最重要的！)
- **硬限制**：什么事情是绝对做不到的？（例如：不能复活死人）
- **软限制/代价**：使用力量会消耗什么？（生命、理智、钱、某种稀有矿石？）

## 力量层级
1. **入门级**：表现形式...
2. **中坚级**：表现形式...
3. **天花板级**：表现形式...
""",

        "03_世界/02_社会政治与势力.md": """# 社会结构

## 政治体系
- **统治形式**：（帝国、联邦、神权、无政府？）
- **主要势力/帮派**：
    1. 势力A：目标是...
    2. 势力B：目标是...

## 阶级与矛盾
- 上层人吃什么？穿什么？
- 底层人吃什么？怕什么？
- 目前最大的社会矛盾是什么？（贫富差距？种族歧视？）
""",

        "03_世界/03_经济与生活细节.md": """# 生活细节 (增加真实感)

## 经济系统
- **货币单位**：
- **购买力参考**：买一个面包多少钱？买一把剑多少钱？

## 日常生活
- **主食**：
- **交通工具**：
- **娱乐方式**：

## 禁忌与风俗
- 绝对不能做的事情是什么？
- 独特的节日有哪些？
""",

        # ==========================
        # 04 正文
        # ==========================
        "04_正文/001_第一章.md": "# 第一章\n\n在此处开始..."
    }

def create_detailed_project(root_path):
    print(f"📘 正在构建深度小说工程：{root_path} ...")
    
    if not os.path.exists(root_path):
        os.makedirs(root_path)

    templates = get_detailed_templates()

    for relative_path, content in templates.items():
        full_path = os.path.join(root_path, relative_path)
        directory = os.path.dirname(full_path)
        
        if not os.path.exists(directory):
            os.makedirs(directory)
            
        # 写入文件，不覆盖已存在的文件（防止手滑删稿）
        if not os.path.exists(full_path):
            with open(full_path, 'w', encoding='utf-8') as f:
                f.write(content)
            print(f"  ✅ [创建] {relative_path}")
        else:
            print(f"  ⚠️ [跳过] {relative_path} (文件已存在)")

    print(f"\n✨ 结构构建完成！")
    print(f"👉 建议从 `00_核心/01_项目圣经.md` 开始填充，然后完善 `03_世界` 中的设定。")

if __name__ == "__main__":
    if len(sys.argv) < 2:
        print("用法: python novel_gen.py <项目路径>")
    else:
        create_detailed_project(sys.argv[1])
